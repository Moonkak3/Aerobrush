(function(){var e={5263:function(e,t,s){"use strict";var n=s(5130),o=s(486),a=s(6768);const i={class:"background"};function r(e,t,s,n,o,r){const c=(0,a.g2)("Toast"),d=(0,a.g2)("HandCursor"),l=(0,a.g2)("BrushSettings"),h=(0,a.g2)("LiveWebStream"),u=(0,a.g2)("TaskBar"),m=(0,a.g2)("DrawingCanvas");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(c,{class:"UI"}),(0,a.Lk)("div",i,[(0,a.bF)(d,{class:"cursor"}),(0,a.bF)(l,{class:"UI"}),(0,a.bF)(h,{class:"UI"}),(0,a.bF)(u,{class:"UI"}),(0,a.bF)(m,{class:"drawing-canvas"})])],64)}const c={key:0,ref:"card"},d={class:"live-stream-container"},l={ref:"videoElement",autoplay:""},h={ref:"canvasElement"};function u(e,t,s,n,o,i){const r=(0,a.g2)("Card");return o.webcamSupported?((0,a.uX)(),(0,a.CE)("div",c,[(0,a.bF)(r,{style:{display:"inline-block"},class:"container"},{header:(0,a.k6)((()=>[(0,a.Lk)("div",d,[(0,a.Lk)("video",l,null,512),(0,a.Lk)("canvas",h,null,512)])])),_:1})],512)):(0,a.Q3)("",!0)}var m=s(9395),p=s(8897),w=s(7861),b=s(9005);class v{constructor(e,t,s=0){this.x=e,this.y=t,this.z=s}}function f(e,t,s=!0){let n=Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2);return s&&(n=Math.sqrt(n)),n}function g(e,t,s=!0){let n=Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)+Math.pow(e.z-t.z,2);return s&&(n=Math.sqrt(n)),n}function y(e,t){return e.x*t.x+e.y*t.y}function k(e,t,s=.5){return new v(e.x*s+t.x*(1-s),e.y*s+t.y*(1-s))}function C(e,t,s){let n=new v(t.x-e.x,t.y-e.y),o=new v(t.x-s.x,t.y-s.y),a=new v(s.x-e.x,s.y-e.y),i=f(e,s,!1);return!(Math.abs(y(n,a))>i||Math.abs(y(o,a))>i)}function M(e,t="pinch"){const s=Math.max(f(e[5],e[17]),f(e[17],e[0]),f(e[0],e[1]),f(e[1],e[5]));let n={mouseDown:!1,close:!1};switch(t){case"pinch":{let t=g(e[4],e[8]),o=g(e[3],e[7]);n.mouseDown=t<o&&t<s/4,n.close=C(e[0],e[12],e[10])&&C(e[0],e[16],e[14])&&C(e[0],e[20],e[18]);break}case"point":n.mouseDown=C(e[3],e[4],e[5])&&g(e[4],e[10])<s,n.close=C(e[0],e[12],e[10])&&C(e[0],e[16],e[14])&&C(e[0],e[20],e[18]);break}return n}function x(e,t="pinch"){let s=null;switch(t){case"pinch":{const t=k(e[4],e[8],.75),n=k(e[3],e[6],.5);s=k(t,n,.25);break}case"point":s=k(e[7],e[8]);break}return[s.x,s.y]}let E=!1,z=null,S=null;function L(e,t,s){const n=document.elementFromPoint(e,t);if(!n)return;const o=new MouseEvent("mousemove",{clientX:e,clientY:t,view:window,bubbles:!0,cancelable:!0});if(n.dispatchEvent(o),n!==z){if(z){const s=new MouseEvent("mouseout",{clientX:e,clientY:t,view:window,bubbles:!0,cancelable:!0,relatedTarget:n});z.dispatchEvent(s)}if(n){const s=new MouseEvent("mouseover",{clientX:e,clientY:t,view:window,bubbles:!0,cancelable:!0,relatedTarget:z});n.dispatchEvent(s)}z=n}if(s&&!E){E=!0,S=n;const s=new MouseEvent("mousedown",{clientX:e,clientY:t,view:window,bubbles:!0,cancelable:!0});n.dispatchEvent(s)}if(!s&&E){E=!1;const s=new MouseEvent("mouseup",{clientX:e,clientY:t,view:window,bubbles:!0,cancelable:!0});if(n.dispatchEvent(s),n===S){const s=new MouseEvent("click",{clientX:e,clientY:t,view:window,bubbles:!0,cancelable:!0});n.dispatchEvent(s)}S=null}}const D=(0,b.nY)("handCursor",{state:()=>({x:0,y:0,mode:"draw",lazyRadius:3,history:[],history_len:2,isDown:!1,isDragging:!1,lastX:0,lastY:0}),actions:{updateHandCursor(e){const t=1.3;let[s,n]=x(e,"pinch");s=(s-.5)*t+.5,n=(n-.5)*t+.5,s*=window.innerWidth,n*=window.innerHeight;const o=s-this.lastX,a=n-this.lastY,i=(o**2+a**2)**.5;if(i<=this.lazyRadius)return;const r=(i-this.lazyRadius)/i;this.x=this.lastX+o*r,this.y=this.lastY+a*r,this.lastX=this.x,this.lastY=this.y,this.history.unshift(M(e,"pinch"));while(this.history.length>this.history_len)this.history.pop();this.history.every((e=>e.mouseDown===this.history[0].mouseDown&&e.close===this.history[0].close))&&(this.gesture=this.history[0]),this.gesture.close?this.mode="draw":this.mode="erase",L(this.x,this.y,this.gesture.mouseDown)}}});var P=s(8333),F={components:{Card:P.A},data(){return{webcamSupported:!0,handLandmarker:void 0,webcamRunning:!0,lastVideoTime:-1,results:void 0,gesture:void 0,handCursor:D()}},mounted(){this.checkWebcamSupport(),this.webcamSupported&&(this.enableWebcam(),this.createHandLandmarker())},methods:{async checkWebcamSupport(){navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||(this.webcamSupported=!1,console.error("getUserMedia() is not supported by your browser"))},async createHandLandmarker(){try{const e=await m.Ps.forVisionTasks("https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@0.10.0/wasm");this.handLandmarker=await m.Vb.createFromOptions(e,{baseOptions:{modelAssetPath:"https://storage.googleapis.com/mediapipe-models/hand_landmarker/hand_landmarker/float16/1/hand_landmarker.task",delegate:"GPU"},runningMode:"VIDEO",numHands:2}),console.log("HandLandmarker initialized.")}catch(e){console.error("Error initializing HandLandmarker:",e)}},async enableWebcam(){const e=this.$refs.videoElement,t={video:{aspectRatio:16/9}};try{const s=await navigator.mediaDevices.getUserMedia(t);e.srcObject=s,e.addEventListener("loadeddata",this.predictWebcam)}catch(s){console.error("Error accessing webcam:",s)}},async predictWebcam(){if(!this.handLandmarker)return void console.log("HandLandmarker is not initialized yet.");const e=this.$refs.videoElement,t=this.$refs.canvasElement,s=t.getContext("2d");t.width=e.clientWidth,t.height=e.clientHeight,this.lastVideoTime!==e.currentTime&&(this.lastVideoTime=e.currentTime,this.results=await this.handLandmarker.detectForVideo(e,performance.now())),s.clearRect(0,0,t.width,t.height),this.results&&this.results.landmarks&&this.interpretLandMarks(this.results.landmarks,s),this.webcamRunning&&window.requestAnimationFrame(this.predictWebcam)},interpretLandMarks(e,t){for(const s of e){const e=s.map((e=>({...e,x:1-e.x})));(0,p.drawConnectors)(t,e,w.HAND_CONNECTIONS,{color:"#00FF00",lineWidth:1}),(0,p.drawLandmarks)(t,e,{color:"#FF0000",radius:1}),this.handCursor.updateHandCursor(e)}}}},_=s(1241);const W=(0,_.A)(F,[["render",u],["__scopeId","data-v-2eb4551e"]]);var O=W;const V={class:"container"};function A(e,t,s,n,o,i){const r=(0,a.g2)("SliderInput"),c=(0,a.g2)("b-colorpicker");return(0,a.uX)(),(0,a.CE)("div",V,[(0,a.bF)(r,{class:"size",modelValue:i.currentMode.size,"onUpdate:modelValue":t[0]||(t[0]=e=>i.currentMode.size=e),min:1,max:100,step:1},null,8,["modelValue"]),(0,a.bF)(c,{modelValue:this.brush.color,"onUpdate:modelValue":t[1]||(t[1]=e=>this.brush.color=e),position:"is-top-left",representation:"triangle"},null,8,["modelValue"]),(0,a.bF)(r,{class:"opacity",modelValue:i.currentMode.opacity,"onUpdate:modelValue":t[2]||(t[2]=e=>i.currentMode.opacity=e),min:0,max:1,step:.01},null,8,["modelValue"])])}const Y=(0,b.nY)("brush",{state:()=>({color:"#0000FF",size:10,opacity:.5})}),$=(0,b.nY)("eraser",{state:()=>({color:"#000000",size:20,opacity:1})});var H=s(4232);const X={class:"slider vertical"};function T(e,t,s,n,o,i){return(0,a.uX)(),(0,a.CE)("div",X,[(0,a.Lk)("div",{ref:"track",class:"track",onMousedown:t[0]||(t[0]=(...e)=>i.startSliding&&i.startSliding(...e))},[(0,a.Lk)("div",{ref:"thumb",class:"thumb",style:(0,H.Tr)({bottom:`${i.valuePercentage}%`})},null,4),(0,a.Lk)("div",{ref:"progress",class:"progress",style:(0,H.Tr)({height:`${i.valuePercentage+10}%`})},null,4)],544)])}var I={name:"SliderInput",props:{modelValue:{type:Number,required:!0},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1}},data(){return{isSliding:!1,startY:0,startValue:this.modelValue}},computed:{valuePercentage(){return(this.modelValue-this.min)/(this.max-this.min)*90}},mounted(){window.addEventListener("mousemove",this.slide),window.addEventListener("mouseup",this.stopSliding)},beforeUnmount(){window.removeEventListener("mousemove",this.slide),window.removeEventListener("mouseup",this.stopSliding)},methods:{startSliding(e){this.isSliding=!0,this.startY=e.clientY,this.startValue=this.modelValue},slide(e){if(!this.isSliding)return;const t=this.$refs.track.clientHeight,s=this.startY-e.clientY,n=Math.max(this.min,Math.min(this.max,this.startValue+s/t*(this.max-this.min))),o=Math.round(n/this.step)*this.step,a=Math.max(this.min,Math.min(this.max,o));this.$emit("update:modelValue",a)},stopSliding(){this.isSliding=!1}}};const N=(0,_.A)(I,[["render",T],["__scopeId","data-v-47a3a028"]]);var U=N,B={components:{SliderInput:U},data(){return{handCursor:D(),brush:Y(),eraser:$(),opacity:1,size:5,color:"#0000FF"}},computed:{currentMode(){return"draw"===this.handCursor.mode?this.brush:"erase"===this.handCursor.mode?this.eraser:this.brush}},mounted(){this.unwatchHandCursor=(0,a.wB)(this.handCursor,(e=>{"draw"===e.mode?(this.opacity=this.brush.opacity,this.size=this.brush.size):"erase"==e.mode&&(this.opacity=this.eraser.opacity,this.size=this.eraser.size)}))},beforeUnmount(){this.unwatchHandCursor()}};const R=(0,_.A)(B,[["render",A],["__scopeId","data-v-fa7c4ee6"]]);var j=R;const q={class:"cursor"};function J(e,t,s,n,o,i){return(0,a.uX)(),(0,a.CE)("div",q)}var G={name:"HandCursor",data(){return{handCursor:D(),brush:Y()}},mounted(){document.addEventListener("mousemove",this.handleMouseMove)},beforeUnmount(){document.removeEventListener("mousemove",this.handleMouseMove)},methods:{handleMouseMove(e){const t=document.querySelector(".cursor");"draw"===this.handCursor.mode?(t.style.mixBlendMode="",t.style.backgroundColor=this.brush.color,t.style.borderColor="#ffffff"):"erase"===this.handCursor.mode&&(t.style.mixBlendMode="difference",t.style.backgroundColor="#ffffff",t.style.borderColor=this.brush.color),t.style.left=e.clientX+"px",t.style.top=e.clientY+"px"}}};const Q=(0,_.A)(G,[["render",J],["__scopeId","data-v-9e8fbd24"]]);var K=Q;const Z={class:"container"},ee={id:"background",ref:"background"};function te(e,t,s,n,o,i){return(0,a.uX)(),(0,a.CE)("div",Z,[(0,a.Lk)("canvas",{id:"canvas",ref:"canvas",onMousedown:t[0]||(t[0]=(...e)=>i.startDrawing&&i.startDrawing(...e)),onMousemove:t[1]||(t[1]=(...e)=>i.draw&&i.draw(...e)),onMouseup:t[2]||(t[2]=(...e)=>i.stopDrawing&&i.stopDrawing(...e)),onDownloadCanvas:t[3]||(t[3]=(...e)=>i.downloadCanvas&&i.downloadCanvas(...e))},null,544),(0,a.Lk)("canvas",ee,null,512)])}var se=s(9521),ne=s.n(se),oe=s(595);const ae=(0,oe.A)();var ie={data(){return{isDrawing:!1,receivedPaths:null,path:null,eraseLayer:null,lazyRadius:10,handCursor:D(),brush:Y(),eraser:$()}},setup(){},mounted(){this.$refs.canvas.width=1920,this.$refs.canvas.height=1080,this.$refs.canvas.left=(window.innerWidth-1920)/2,this.$refs.canvas.top=(window.innerHeight-1080)/2,this.$refs.background.width=1920,this.$refs.background.height=1080,this.$refs.background.left=(window.innerWidth-1920)/2,this.$refs.background.top=(window.innerHeight-1080)/2,ne().setup(this.$refs.canvas),ae.on("download",this.downloadCanvas),this.receivedPaths={},this.websocket=new WebSocket(`ws://${window.location.hostname}:8765`),this.websocket.onopen=()=>{console.log("WebSocket connection opened at "+window.location.hostname)},this.websocket.onmessage=e=>{const t=JSON.parse(e.data);this.handleReceivedData(t)},this.websocket.onclose=()=>{console.log("WebSocket connection closed")}},beforeUnmount(){ne().projects.forEach((e=>{e.remove()})),this.websocket&&this.websocket.close(),ae.off("download",this.downloadCanvas)},methods:{startDrawing(){"draw"===this.handCursor.mode?this.path=new(ne().Path)({strokeColor:this.brush.color,strokeWidth:this.brush.size,opacity:this.brush.opacity,strokeCap:"round",blendMode:"normal"}):"erase"===this.handCursor.mode&&(this.path=new(ne().Path)({strokeColor:this.eraser.color,strokeWidth:this.eraser.size,opacity:this.eraser.opacity,strokeCap:"round",blendMode:"destination-out"}));const e={points:this.path.segments.map((e=>({x:e.point.x,y:e.point.y}))),strokeColor:this.brush.color,strokeWidth:this.path.strokeWidth,opacity:this.path.opacity,blendMode:this.path.blendMode};this.websocket&&this.websocket.readyState===WebSocket.OPEN&&this.websocket.send(JSON.stringify({action:"startDrawing",path:e})),this.isDrawing=!0,ne().view.draw()},draw(e){if(!this.isDrawing)return;const t=e.clientX-this.$refs.canvas.offsetLeft,s=e.clientY-this.$refs.canvas.offsetTop;this.websocket&&this.websocket.readyState===WebSocket.OPEN?this.websocket.send(JSON.stringify({action:"draw",point:{x:t,y:s}})):(this.path.add(new(ne().Point)(t,s)),this.path.smooth({type:"continuous"}))},stopDrawing(){if(this.path){if(this.websocket&&this.websocket.readyState===WebSocket.OPEN)this.websocket.send(JSON.stringify({action:"stopDrawing"}));else{this.isDrawing=!1,this.path.simplify();const e=this.path.blendMode;this.path.blendMode="normal";let t=this.path.rasterize();this.path.remove(),t.blendMode=e}ne().view.draw()}},handleReceivedData(e){switch(e.action){case"startDrawing":{const t=new(ne().Path)({strokeColor:e.path.strokeColor,strokeWidth:e.path.strokeWidth,opacity:e.path.opacity,strokeCap:"round",blendMode:e.path.blendMode});this.receivedPaths[e.id]=t;break}case"draw":this.receivedPaths[e.id]&&(this.receivedPaths[e.id].add(new(ne().Point)(e.point.x,e.point.y)),this.receivedPaths[e.id].smooth({type:"continuous"}));break;case"stopDrawing":if(this.receivedPaths[e.id]){this.receivedPaths[e.id].simplify();const t=this.receivedPaths[e.id].blendMode;this.receivedPaths[e.id].blendMode="normal";let s=this.receivedPaths[e.id].rasterize();s.blendMode=t,this.receivedPaths[e.id].remove(),this.receivedPaths[e.id]=null,ne().view.draw();break}}},downloadCanvas(){console.log("downloading...");const e=this.$refs.canvas;if(!e)return void console.error("Canvas element is not available.");const t=e.toDataURL("image/png"),s=document.createElement("a");s.href=t,s.download="canvas-image.png",s.click()}}};const re=(0,_.A)(ie,[["render",te],["__scopeId","data-v-166cefd2"]]);var ce=re;const de=e=>((0,a.Qi)("data-v-dff65d7e"),e=e(),(0,a.jt)(),e),le={class:"container"},he=de((()=>(0,a.Lk)("i",{class:"pi pi-pencil"},null,-1))),ue=de((()=>(0,a.Lk)("i",{class:"pi pi-eraser"},null,-1))),me=de((()=>(0,a.Lk)("i",{class:"pi pi-download"},null,-1))),pe=["value"];function we(e,t,s,n,o,i){const r=(0,a.g2)("Button");return(0,a.uX)(),(0,a.CE)("div",le,[(0,a.bF)(r,{class:(0,H.C4)({"p-button-primary":"draw"===e.handCursor.mode}),text:"",rounded:"","aria-label":"Draw",onClick:t[0]||(t[0]=t=>e.selectButton("draw"))},{default:(0,a.k6)((()=>[he])),_:1},8,["class"]),(0,a.bF)(r,{class:(0,H.C4)({"p-button-primary":"erase"===e.handCursor.mode}),text:"",rounded:"","aria-label":"Erase",onClick:t[1]||(t[1]=t=>e.selectButton("erase"))},{default:(0,a.k6)((()=>[ue])),_:1},8,["class"]),(0,a.bF)(r,{text:"",rounded:"","aria-label":"Download",onClick:e.downloadCanvas},{default:(0,a.k6)((()=>[me])),_:1},8,["onClick"]),(0,a.bF)(r,{text:"",rounded:"","aria-label":"Share",onClick:e.share},{default:(0,a.k6)((()=>[(0,a.Lk)("i",{class:"pi pi-link",value:e.link,ref:"share"},null,8,pe)])),_:1},8,["onClick"])])}var be=s(3830),ve=s(5236),fe=(0,a.pM)({components:{Button:ve.A},data(){return{toast:null}},setup(){const e=D(),t=t=>{e.mode=t};return{handCursor:e,selectButton:t}},mounted(){this.toast=(0,be.d)()},computed:{link(){return window.location.href}},methods:{downloadCanvas(){console.log("clicked download"),ae.emit("download"),this.toast.add({severity:"contrast",summary:"Downloading whiteboard as PNG",detail:"Check your downloads folder for the image file",life:5e3})},share(){var e=document.createElement("textarea");e.value=window.location.href,e.style.top="0",e.style.left="0",e.style.position="fixed",document.body.appendChild(e),e.focus(),e.select();try{var t=document.execCommand("copy");t&&this.toast.add({severity:"contrast",summary:"Link copied successfully!",detail:"Paste this link into your browser on a device connected to the same network to share the whiteboard.\n                        Does not work on github pages.",life:5e3});var s=t?"successful":"unsuccessful";console.log("Fallback: Copying text command was "+s)}catch(n){console.error("Fallback: Oops, unable to copy",n)}document.body.removeChild(e)}}});const ge=(0,_.A)(fe,[["render",we],["__scopeId","data-v-dff65d7e"]]);var ye=ge,ke=s(1401);document.body.style.cursor="none";var Ce={name:"App",components:{BrushSettings:j,LiveWebStream:O,HandCursor:K,DrawingCanvas:ce,TaskBar:ye,Toast:ke.A}};const Me=(0,_.A)(Ce,[["render",r],["__scopeId","data-v-8ee52434"]]);var xe=Me,Ee=s(8253),ze=s(8460),Se=s(9890),Le=s(786);s(1457);const De=(0,b.Ey)(),Pe=(0,n.Ef)(xe);Pe.use(o.A),Pe.use(De);const Fe=(0,ze.FA)(Se.A,{semantic:{primary:{50:"{zinc.50}",100:"{zinc.100}",200:"{zinc.200}",300:"{zinc.300}",400:"{zinc.400}",500:"{zinc.500}",600:"{zinc.600}",700:"{zinc.700}",800:"{zinc.800}",900:"{zinc.900}",950:"{zinc.950}"},colorScheme:{light:{primary:{color:"{zinc.50}",inverseColor:"{zinc.950}",hoverColor:"{zinc.100}",activeColor:"{zinc.200}"},highlight:{background:"rgba(250, 250, 250, .16)",focusBackground:"rgba(250, 250, 250, .24)",color:"rgba(255,255,255,.87)",focusColor:"rgba(255,255,255,.87)"}},dark:{primary:{color:"{zinc.50}",inverseColor:"{zinc.950}",hoverColor:"{zinc.100}",activeColor:"{zinc.200}"},highlight:{background:"rgba(250, 250, 250, .16)",focusBackground:"rgba(250, 250, 250, .24)",color:"rgba(255,255,255,.87)",focusColor:"rgba(255,255,255,.87)"}}}}});Pe.use(Ee.Ay,{theme:{preset:Fe}}),Pe.use(Le.Ay),Pe.mount("#app")},6999:function(){},2965:function(){}},t={};function s(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={exports:{}};return e[n].call(a.exports,a,a.exports,s),a.exports}s.m=e,function(){var e=[];s.O=function(t,n,o,a){if(!n){var i=1/0;for(l=0;l<e.length;l++){n=e[l][0],o=e[l][1],a=e[l][2];for(var r=!0,c=0;c<n.length;c++)(!1&a||i>=a)&&Object.keys(s.O).every((function(e){return s.O[e](n[c])}))?n.splice(c--,1):(r=!1,a<i&&(i=a));if(r){e.splice(l--,1);var d=o();void 0!==d&&(t=d)}}return t}a=a||0;for(var l=e.length;l>0&&e[l-1][2]>a;l--)e[l]=e[l-1];e[l]=[n,o,a]}}(),function(){s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,{a:t}),t}}(),function(){s.d=function(e,t){for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={524:0};s.O.j=function(t){return 0===e[t]};var t=function(t,n){var o,a,i=n[0],r=n[1],c=n[2],d=0;if(i.some((function(t){return 0!==e[t]}))){for(o in r)s.o(r,o)&&(s.m[o]=r[o]);if(c)var l=c(s)}for(t&&t(n);d<i.length;d++)a=i[d],s.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return s.O(l)},n=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=s.O(void 0,[504],(function(){return s(5263)}));n=s.O(n)})();
//# sourceMappingURL=app.52c5c09f.js.map